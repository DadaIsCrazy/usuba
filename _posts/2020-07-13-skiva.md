---
layout: post
title: SKIVA, Flexible and Modular Side-channel and Fault Countermeasures
date: "2020-07-13 00:00:00"
description: 
lang: en
locale: en_US
author: Darius Mercadier
excerpt: 
comments: false
hidden: true
---

<!-- TODO: reformulate!! --> 

Fault attacks [1,2,3,4] consist in tampering with a device in order to
induce faults in its computations. Many ways exist to do so:
under-powering [14] or over-powering [5,11], blasting ionizing light
(_eg._ lasers) [8,9,12], heating up or cooling down [7], inducing
clock glitching [6,10], or using electromagnetic (EM) impulsions
[12,13].




Fault attacks:

 - algorithm modification: 
   + Fault on the data. Example on Eliptic curve cryptography [27]
   + Fault on the control flow: skipping an instruction [28], replacing instructions [10].
 
 - differential fault analysis (DFA) [15] uses correct and faulty
   ciphertexts from the same plaintexts and applies differential
   cryptanalysis techniques to recover the key.
 
 - Safe Error Attack (SEA) [23] observes wether a fault as an impact
   on the output, and deduce values of some variables.
 
 - statistical fault analysis (SFA) [24] don't require to know
   plaintext: inject fault at chosen location, and decrypt the
   ciphertext back to where the fault was injected.

 - Innefective Fault Attacks (IFA) [25] quite like SEA: observes if
   modifying (_eg._ stuck-at-zero) an intermediate value affects the
   result: if no, then the original value was 0 as well.
 
 - SIFA (based IFA and SFA) [26] similar to SFA but uses only
   ineffective faults to deduce a bias in the distribution of the
   plaintext.
 
 
Risks of combining fault resistance and SCA resistance:

 - [19,20] error detection/correction on AES increases leakage (and
   vulnerability to power analysis attacks).
   
Combined countermeasures:

 - ParTI [17]. Hardware. Based on Threshold implementation [21] for
   SCA resistance, and error detecting codes [22].

 - CAPA [16] detects more faults than [17]. Provable security against
   combined attacks. Hardware, but adapatable to software under some
   constraints on the architecture. Based on secure multi-party
   computation protocols (MPC). Costly.

 - ... [18] by design in the cipher.


## SKIVA

Custom 32-bit processor to protect against fault attacks
(DFA/SFA/SIFA) and side-channel analysis (timing-based and
power-based). Timing-based: bitslicing. Power-based: masking. Fault
attacks: redundancy (temporal and spatial).

Can combine them thanks to bitslicing. 

- 1/2/4 shares for masking at order 0, 1 and 3. NINA gadgets [29]. 

- 1/2/4 redundant bytes. 

- Temporal redundancy (1/2). 
  + Figure 3 paper ("Time-redundant computation of a bitsliced AES")

Depends on the attacker model.

+ Figure 2 paper ("bitslice aggregations on a 32 bit register")

+ Figure Slide 30 VERISICC (attacker models)


## Custom instructions

- Redundancy (ANDC/XORC...)

- Bitslicing: 


## Results

SCA not mentionned here: done by Pantea/Patrick.


### Throughput

Copy-pasta from paper


### Fault analysis

- theoretically sound against data faults

- In practice, simulated fault attacks using gdb




---
## References

[1] D. Boneh _et al._, [On the Importance of Checking Cryptographic Protocols for Faults](https://link.springer.com/content/pdf/10.1007/3-540-69053-0_4.pdf), EUROCRYPT, 1997.

[2] H. Bar-El _et al._, [The sorcerer's apprentice guide to fault attacks](https://www.hbarel.com/media/blogs/hagai-on-security/Sorcerers_Apprentice_Guide.pdf), 2004.

[3] Dusko Karaklajic _et al._, [Hardware designer's guide to fault attacks](https://lirias.kuleuven.be/retrieve/334153), 2013.

[4] A. Barenghi _et al._, [Fault Injection Attacks on Cryptographic Devices: Theory, Practice and Countermeasures](https://core.ac.uk/reader/207745588), 2012.

[5] C. Aumüller _et al._, [Fault Attacks on RSA with CRT: Concrete Results and Practical Countermeasures](https://link.springer.com/content/pdf/10.1007/3-540-36400-5_20.pdf), CHES, 2002.

[6] R. Anderson, M. Kuhn, [Low Cost Attacks on Tamper Resistant Devices](https://www.cl.cam.ac.uk/~rja14/Papers/tamper2.pdf), Security Protocols Workshop, 1997.

[7] S. Skorobogatov, [Low Temperature Data Remanence in Static RAM](https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-536.pdf), 2002.

[8] S. P. Skorobogatov, R. J. Anderson, [Optical Fault Induction Attacks](https://link.springer.com/content/pdf/10.1007/3-540-36400-5_2.pdf), CHES, 2002.

[9] D. H. Habing, [The use of lasers to simulate radiation-induced transients in semiconductor devices and circuits](https://www.osti.gov/servlets/purl/4609524), 1965.

[10] J. Balasch _et al._, [An In-depth and Blackbox Characterization of the Effects of Clock Glitches on 8-bit MCUs](https://www.esat.kuleuven.be/cosic/publications/article-2059.pdf), FDTC, 2011.

[11] O. Kömmerling, M. G. Kuhn, [Design Principles for Tamper-Resistant Smartcard Processors](https://static.usenix.org/events/smartcard99/full_papers/kommerling/kommerling.pdf), Smartcard, 1999.

[12] J.-M. Schmidt, M. Hutter, [Optical and EM Fault-Attacks on CRT-based RSA: Concrete Results](http://mhutter.org/papers/Schmidt2007OpticalandEM.pdf), 2007.

[13] J.-J. Quisquater, D. Samyde, Eddy current for magnetic analysis with active sensor, Esmart, 2002.

[14] J. J. A. Fournier _et al._, [Security Evaluation of Asynchronous Circuits](https://link.springer.com/content/pdf/10.1007/978-3-540-45238-6_12.pdf), CHES, 2003.

[15] E. Biham, A. Shamir, [Differential Fault Analysis of Secret Key Cryptosystems](https://link.springer.com/content/pdf/10.1007/BFb0052259.pdf), CRYPTO, 1997.

[16] O. Reparaz _et al._, [CAPA: The Spirit of Beaver Against Physical Attacks](https://lirias.kuleuven.be/retrieve/513735), CRYPTO, 2018.

[17] T. Schneider _et al._, [ParTI – Towards Combined Hardware Countermeasures against Side-Channel and Fault-Injection Attacks](https://eprint.iacr.org/2016/648.pdf), CRYPTO, 2016.

[18] T. Simon _et al._, [Towards Lightweight Cryptographic Primitives with Built-in Fault-Detection](http://kpcrypto.net/drupal41k/sites/default/files/papers/frit.pdf), 2018.

[19] F. Regazzoni _et al._, [Interaction between fault attack countermeasures and the resistance against power analysis attacks](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.352.5743&rep=rep1&type=pdf), Fault Analysis in Cryptography, 2012.

[20] L. Cojocar _et al._, [Instruction duplication: Leaky and not too fault-tolerant!](https://eprint.iacr.org/2017/1082.pdf), CARDIS, 2017.

[21] S. Nikova _et al._, [Threshold Implementations Against Side-Channel Attacks and Glitches](https://link.springer.com/content/pdf/10.1007/11935308_38.pdf), ICICS, 2006.

[22] F. J. MacWilliams, N. J. A. Sloane, [The theory of error correcting codes](https://d1wqtxts1xzle7.cloudfront.net/43668701/linear_codes.pdf?1457829042=&response-content-disposition=inline%3B+filename%3DNorth-Holland_Mathematical_Library.pdf&Expires=1595332479&Signature=YQzw3AL~n07TETzZTBUXzMtAcEPvpbdBL6JcGSpC9ZnKOtKlssYILgjoHQPlNVHYJmLIjJb2GtVny~UGK7XEdwqN4gm-L3FQf0x-HxTH2yJKlGRX4e7Yu8xTl0QqysWBOoFM~Oe7xFGKnDrpCqItYxfKsRS7ozmvJ6mSQYHiRdwW12RI742WJNLwYfV-21dt8SaTxuqtF9t3w~9SDA9X6om0ShcMT3nDr3m6vahlrA9TmjDoEIET7il1K1pht2unwPJ~92iK2a4JpZ52hr4MlyvKLeNVONkerX01l8hEPTMGWAbf1qZzP-RrGz0jG9ij6ZztcVE-jcTSALC5STINIA__&Key-Pair-Id=APKAJLOHF5GGSLRBV4ZA), 1977.

[23] S. M. Yen, M. Joye, [Checking Before Output May Not Be Enough Against Fault-Based Cryptanalysis](https://pdfs.semanticscholar.org/a610/48f7b67b4f8db7e944d438add57a9a62ac08.pdf), 2000.

[24] T. Fuhr _et al._, [Fault attacks on AES with faulty ciphertexts only](https://www.ssi.gouv.fr/uploads/IMG/pdf/Fault_Attacks_on_AES_with_Faulty_Ciphertexts_Only.pdf), FDTC, 2013.

[25] C. Clavier, [Secret external encodings do not prevent transient fault analysis](https://link.springer.com/content/pdf/10.1007/978-3-540-74735-2_13.pdf), CHES, 2007.

[26] C. Dobraunig _et al._, [SIFA: Exploiting Ineffective Fault Inductions on Symmetric Cryptography](https://eprint.iacr.org/2018/071.pdf), 2018.

[27] M. Ciet, M. Joye, [Elliptic Curve Cryptosystems in the Presence of Permanent and Transient Faults](https://link.springer.com/content/pdf/10.1007/s10623-003-1160-8.pdf), Designs, codes and cryptography, 2005.

[28] J.-M. Schmidt, C. Herbst, [A Practical Fault Attack on Square and Multiply](https://ieeexplore.ieee.org/document/4599557), FDTC, 2008.

[29] S. Dhooghe, S. Nikova, [My Gadget Just Cares For Me - How NINA Can Prove Security Against Combined Attacks](https://eprint.iacr.org/2019/615.pdf), 2019.
