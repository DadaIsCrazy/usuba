node sbox_1 (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_ )
     returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_
let
    x1 = not(a4);
	x2 = not(a1);
	x3 = xor(a4,a3);
	x4 = xor(x3,x2);
	x5 = or(a3,x2);
	x6 = and(x5,x1);
	x7 = or(a6,x6);
	x8 = xor(x4,x7);
	x9 = or(x1,x2);
	x10 = and(a6,x9);
	x11 = xor(x7,x10);
	x12 = or(a2,x11);
	x13 = xor(x8,x12);
	x14 = xor(x9,x13);
	x15 = or(a6,x14);
	x16 = xor(x1,x15);
	x17 = not(x14);
	x18 = and(x17,x3);
	x19 = or(a2,x18);
	x20 = xor(x16,x19);
	x21 = or(a5,x20);
	x22 = xor(x13,x21);
	out4 = x22;
	x23 = or(a3,x4);
	x24 = not(x23);
	x25 = or(a6,x24);
	x26 = xor(x6,x25);
	x27 = and(x1,x8);
	x28 = or(a2,x27);
	x29 = xor(x26,x28);
	x30 = or(x1,x8);
	x31 = xor(x30,x6);
	x32 = and(x5,x14);
	x33 = xor(x32,x8);
	x34 = and(a2,x33);
	x35 = xor(x31,x34);
	x36 = or(a5,x35);
	x37 = xor(x29,x36);
	out1 = x37;
	x38 = and(a3,x10);
	x39 = or(x38,x4);
	x40 = and(a3,x33);
	x41 = xor(x40,x25);
	x42 = or(a2,x41);
	x43 = xor(x39,x42);
	x44 = or(a3,x26);
	x45 = xor(x44,x14);
	x46 = or(a1,x8);
	x47 = xor(x46,x20);
	x48 = or(a2,x47);
	x49 = xor(x45,x48);
	x50 = and(a5,x49);
	x51 = xor(x43,x50);
	out2 = x51;
	x52 = xor(x8,x40);
	x53 = xor(a3,x11);
	x54 = and(x53,x5);
	x55 = or(a2,x54);
	x56 = xor(x52,x55);
	x57 = or(a6,x4);
	x58 = xor(x57,x38);
	x59 = and(x13,x56);
	x60 = and(a2,x59);
	x61 = xor(x58,x60);
	x62 = and(a5,x61);
	x63 = xor(x56,x62);
	out3 = x63
tel

node sbox_2 (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_ )
     returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_
let
    	x1 = not(a5);
	x2 = not(a1);
	x3 = xor(a5,a6);
	x4 = xor(x3,x2);
	x5 = xor(x4,a2);
	x6 = or(a6,x1);
	x7 = or(x6,x2);
	x8 = and(a2,x7);
	x9 = xor(a6,x8);
	x10 = and(a3,x9);
	x11 = xor(x5,x10);
	x12 = and(a2,x9);
	x13 = xor(a5,x6);
	x14 = or(a3,x13);
	x15 = xor(x12,x14);
	x16 = and(a4,x15);
	x17 = xor(x11,x16);
	out2 = x17;
	x18 = or(a5,a1);
	x19 = or(a6,x18);
	x20 = xor(x13,x19);
	x21 = xor(x20,a2);
	x22 = or(a6,x4);
	x23 = and(x22,x17);
	x24 = or(a3,x23);
	x25 = xor(x21,x24);
	x26 = or(a6,x2);
	x27 = and(a5,x2);
	x28 = or(a2,x27);
	x29 = xor(x26,x28);
	x30 = xor(x3,x27);
	x31 = xor(x2,x19);
	x32 = and(a2,x31);
	x33 = xor(x30,x32);
	x34 = and(a3,x33);
	x35 = xor(x29,x34);
	x36 = or(a4,x35);
	x37 = xor(x25,x36);
	out3 = x37;
	x38 = and(x21,x32);
	x39 = xor(x38,x5);
	x40 = or(a1,x15);
	x41 = xor(x40,x13);
	x42 = or(a3,x41);
	x43 = xor(x39,x42);
	x44 = or(x28,x41);
	x45 = and(a4,x44);
	x46 = xor(x43,x45);
	out1 = x46;
	x47 = and(x19,x21);
	x48 = xor(x47,x26);
	x49 = and(a2,x33);
	x50 = xor(x49,x21);
	x51 = and(a3,x50);
	x52 = xor(x48,x51);
	x53 = and(x18,x28);
	x54 = and(x53,x50);
	x55 = or(a4,x54);
	x56 = xor(x52,x55);
	out4 = x56
tel

node sbox_3 (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_ )
     returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_
let
    x1 = not(a5);
	x2 = not(a6);
	x3 = and(a5,a3);
	x4 = xor(x3,a6);
	x5 = and(a4,x1);
	x6 = xor(x4,x5);
	x7 = xor(x6,a2);
	x8 = and(a3,x1);
	x9 = xor(a5,x2);
	x10 = or(a4,x9);
	x11 = xor(x8,x10);
	x12 = and(x7,x11);
	x13 = xor(a5,x11);
	x14 = or(x13,x7);
	x15 = and(a4,x14);
	x16 = xor(x12,x15);
	x17 = and(a2,x16);
	x18 = xor(x11,x17);
	x19 = and(a1,x18);
	x20 = xor(x7,x19);
	out4 = x20;
	x21 = xor(a3,a4);
	x22 = xor(x21,x9);
	x23 = or(x2,x4);
	x24 = xor(x23,x8);
	x25 = or(a2,x24);
	x26 = xor(x22,x25);
	x27 = xor(a6,x23);
	x28 = or(x27,a4);
	x29 = xor(a3,x15);
	x30 = or(x29,x5);
	x31 = or(a2,x30);
	x32 = xor(x28,x31);
	x33 = or(a1,x32);
	x34 = xor(x26,x33);
	out1 = x34;
	x35 = xor(a3,x9);
	x36 = or(x35,x5);
	x37 = or(x4,x29);
	x38 = xor(x37,a4);
	x39 = or(a2,x38);
	x40 = xor(x36,x39);
	x41 = and(a6,x11);
	x42 = or(x41,x6);
	x43 = xor(x34,x38);
	x44 = xor(x43,x41);
	x45 = and(a2,x44);
	x46 = xor(x42,x45);
	x47 = or(a1,x46);
	x48 = xor(x40,x47);
	out3 = x48;
	x49 = or(x2,x38);
	x50 = xor(x49,x13);
	x51 = xor(x27,x28);
	x52 = or(a2,x51);
	x53 = xor(x50,x52);
	x54 = and(x12,x23);
	x55 = and(x54,x52);
	x56 = or(a1,x55);
	x57 = xor(x53,x56);
	out2 = x57
tel

node sbox_4 (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_ )
     returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_
let
    x1 = not(a1);
	x2 = not(a3);
	x3 = or(a1,a3);
	x4 = and(a5,x3);
	x5 = xor(x1,x4);
	x6 = or(a2,a3);
	x7 = xor(x5,x6);
	x8 = and(a1,a5);
	x9 = xor(x8,x3);
	x10 = and(a2,x9);
	x11 = xor(a5,x10);
	x12 = and(a4,x11);
	x13 = xor(x7,x12);
	x14 = xor(x2,x4);
	x15 = and(a2,x14);
	x16 = xor(x9,x15);
	x17 = and(x5,x14);
	x18 = xor(a5,x2);
	x19 = or(a2,x18);
	x20 = xor(x17,x19);
	x21 = or(a4,x20);
	x22 = xor(x16,x21);
	x23 = and(a6,x22);
	x24 = xor(x13,x23);
	out2 = x24;
	x25 = not(x13);
	x26 = or(a6,x22);
	x27 = xor(x25,x26);
	out1 = x27;
	x28 = and(a2,x11);
	x29 = xor(x28,x17);
	x30 = xor(a3,x10);
	x31 = xor(x30,x19);
	x32 = and(a4,x31);
	x33 = xor(x29,x32);
	x34 = xor(x25,x33);
	x35 = and(a2,x34);
	x36 = xor(x24,x35);
	x37 = or(a4,x34);
	x38 = xor(x36,x37);
	x39 = and(a6,x38);
	x40 = xor(x33,x39);
	out4 = x40;
	x41 = xor(x26,x38);
	x42 = xor(x41,x40);
	out3 = x42
tel


node sbox_5 (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_ )
     returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_
let
    	x1 = not(a6);
	x2 = not(a3);
	x3 = or(x1,x2);
	x4 = xor(x3,a4);
	x5 = and(a1,x3);
	x6 = xor(x4,x5);
	x7 = or(a6,a4);
	x8 = xor(x7,a3);
	x9 = or(a3,x7);
	x10 = or(a1,x9);
	x11 = xor(x8,x10);
	x12 = and(a5,x11);
	x13 = xor(x6,x12);
	x14 = not(x4);
	x15 = and(x14,a6);
	x16 = or(a1,x15);
	x17 = xor(x8,x16);
	x18 = or(a5,x17);
	x19 = xor(x10,x18);
	x20 = or(a2,x19);
	x21 = xor(x13,x20);
	out3 = x21;
	x22 = or(x2,x15);
	x23 = xor(x22,a6);
	x24 = xor(a4,x22);
	x25 = and(a1,x24);
	x26 = xor(x23,x25);
	x27 = xor(a1,x11);
	x28 = and(x27,x22);
	x29 = or(a5,x28);
	x30 = xor(x26,x29);
	x31 = or(a4,x27);
	x32 = not(x31);
	x33 = or(a2,x32);
	x34 = xor(x30,x33);
	out2 = x34;
	x35 = xor(x2,x15);
	x36 = and(a1,x35);
	x37 = xor(x14,x36);
	x38 = xor(x5,x7);
	x39 = and(x38,x34);
	x40 = or(a5,x39);
	x41 = xor(x37,x40);
	x42 = xor(x2,x5);
	x43 = and(x42,x16);
	x44 = and(x4,x27);
	x45 = and(a5,x44);
	x46 = xor(x43,x45);
	x47 = or(a2,x46);
	x48 = xor(x41,x47);
	out1 = x48;
	x49 = and(x24,x48);
	x50 = xor(x49,x5);
	x51 = xor(x11,x30);
	x52 = or(x51,x50);
	x53 = and(a5,x52);
	x54 = xor(x50,x53);
	x55 = xor(x14,x19);
	x56 = xor(x55,x34);
	x57 = xor(x4,x16);
	x58 = and(x57,x30);
	x59 = and(a5,x58);
	x60 = xor(x56,x59);
	x61 = or(a2,x60);
	x62 = xor(x54,x61);
	out4 = x62
tel

node sbox_6 (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_ )
     returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_
let
    x1 = not(a2);
	x2 = not(a5);
	x3 = xor(a2,a6);
	x4 = xor(x3,x2);
	x5 = xor(x4,a1);
	x6 = and(a5,a6);
	x7 = or(x6,x1);
	x8 = and(a5,x5);
	x9 = and(a1,x8);
	x10 = xor(x7,x9);
	x11 = and(a4,x10);
	x12 = xor(x5,x11);
	x13 = xor(a6,x10);
	x14 = and(x13,a1);
	x15 = and(a2,a6);
	x16 = xor(x15,a5);
	x17 = and(a1,x16);
	x18 = xor(x2,x17);
	x19 = or(a4,x18);
	x20 = xor(x14,x19);
	x21 = and(a3,x20);
	x22 = xor(x12,x21);
	out2 = x22;
	x23 = xor(a6,x18);
	x24 = and(a1,x23);
	x25 = xor(a5,x24);
	x26 = xor(a2,x17);
	x27 = or(x26,x6);
	x28 = and(a4,x27);
	x29 = xor(x25,x28);
	x30 = not(x26);
	x31 = or(a6,x29);
	x32 = not(x31);
	x33 = and(a4,x32);
	x34 = xor(x30,x33);
	x35 = and(a3,x34);
	x36 = xor(x29,x35);
	out4 = x36;
	x37 = xor(x6,x34);
	x38 = and(a5,x23);
	x39 = xor(x38,x5);
	x40 = or(a4,x39);
	x41 = xor(x37,x40);
	x42 = or(x16,x24);
	x43 = xor(x42,x1);
	x44 = xor(x15,x24);
	x45 = xor(x44,x31);
	x46 = or(a4,x45);
	x47 = xor(x43,x46);
	x48 = or(a3,x47);
	x49 = xor(x41,x48);
	out1 = x49;
	x50 = or(x5,x38);
	x51 = xor(x50,x6);
	x52 = and(x8,x31);
	x53 = or(a4,x52);
	x54 = xor(x51,x53);
	x55 = and(x30,x43);
	x56 = or(a3,x55);
	x57 = xor(x54,x56);
	out3 = x57
tel


node sbox_7 (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_ )
     returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_
let
    x1 = not(a2);
	x2 = not(a5);
	x3 = and(a2,a4);
	x4 = xor(x3,a5);
	x5 = xor(x4,a3);
	x6 = and(a4,x4);
	x7 = xor(x6,a2);
	x8 = and(a3,x7);
	x9 = xor(a1,x8);
	x10 = or(a6,x9);
	x11 = xor(x5,x10);
	x12 = and(a4,x2);
	x13 = or(x12,a2);
	x14 = or(a2,x2);
	x15 = and(a3,x14);
	x16 = xor(x13,x15);
	x17 = xor(x6,x11);
	x18 = or(a6,x17);
	x19 = xor(x16,x18);
	x20 = and(a1,x19);
	x21 = xor(x11,x20);
	out1 = x21;
	x22 = or(a2,x21);
	x23 = xor(x22,x6);
	x24 = xor(x23,x15);
	x25 = xor(x5,x6);
	x26 = or(x25,x12);
	x27 = or(a6,x26);
	x28 = xor(x24,x27);
	x29 = and(x1,x19);
	x30 = and(x23,x26);
	x31 = and(a6,x30);
	x32 = xor(x29,x31);
	x33 = or(a1,x32);
	x34 = xor(x28,x33);
	out4 = x34;
	x35 = and(a4,x16);
	x36 = or(x35,x1);
	x37 = and(a6,x36);
	x38 = xor(x11,x37);
	x39 = and(a4,x13);
	x40 = or(a3,x7);
	x41 = xor(x39,x40);
	x42 = or(x1,x24);
	x43 = or(a6,x42);
	x44 = xor(x41,x43);
	x45 = or(a1,x44);
	x46 = xor(x38,x45);
	out2 = x46;
	x47 = xor(x8,x44);
	x48 = xor(x6,x15);
	x49 = or(a6,x48);
	x50 = xor(x47,x49);
	x51 = xor(x19,x44);
	x52 = xor(a4,x25);
	x53 = and(x52,x46);
	x54 = and(a6,x53);
	x55 = xor(x51,x54);
	x56 = or(a1,x55);
	x57 = xor(x50,x56);
	out3 = x57
tel


node sbox_8 (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_ )
     returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_
let
    x1 = not(a1);
	x2 = not(a4);
	x3 = xor(a3,x1);
	x4 = or(a3,x1);
	x5 = xor(x4,x2);
	x6 = or(a5,x5);
	x7 = xor(x3,x6);
	x8 = or(x1,x5);
	x9 = xor(x2,x8);
	x10 = and(a5,x9);
	x11 = xor(x8,x10);
	x12 = and(a2,x11);
	x13 = xor(x7,x12);
	x14 = xor(x6,x9);
	x15 = and(x3,x9);
	x16 = and(a5,x8);
	x17 = xor(x15,x16);
	x18 = or(a2,x17);
	x19 = xor(x14,x18);
	x20 = or(a6,x19);
	x21 = xor(x13,x20);
	out1 = x21;
	x22 = or(a5,x3);
	x23 = and(x22,x2);
	x24 = not(a3);
	x25 = and(x24,x8);
	x26 = and(a5,x4);
	x27 = xor(x25,x26);
	x28 = or(a2,x27);
	x29 = xor(x23,x28);
	x30 = and(a6,x29);
	x31 = xor(x13,x30);
	out4 = x31;
	x32 = xor(x5,x6);
	x33 = xor(x32,x22);
	x34 = or(a4,x13);
	x35 = and(a2,x34);
	x36 = xor(x33,x35);
	x37 = and(a1,x33);
	x38 = xor(x37,x8);
	x39 = xor(a1,x23);
	x40 = and(x39,x7);
	x41 = and(a2,x40);
	x42 = xor(x38,x41);
	x43 = or(a6,x42);
	x44 = xor(x36,x43);
	out3 = x44;
	x45 = xor(a1,x10);
	x46 = xor(x45,x22);
	x47 = not(x7);
	x48 = and(x47,x8);
	x49 = or(a2,x48);
	x50 = xor(x46,x49);
	x51 = xor(x19,x29);
	x52 = or(x51,x38);
	x53 = and(a6,x52);
	x54 = xor(x50,x53);
	out2 = x54
tel


node expand (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_,
        a7:bool::_, a8:bool::_, a9:bool::_, a10:bool::_, a11:bool::_, a12:bool::_,
        a13:bool::_, a14:bool::_, a15:bool::_, a16:bool::_, a17:bool::_, a18:bool::_,
        a19:bool::_, a20:bool::_, a21:bool::_, a22:bool::_, a23:bool::_, a24:bool::_,
        a25:bool::_, a26:bool::_, a27:bool::_, a28:bool::_, a29:bool::_, a30:bool::_,
        a31:bool::_, a32:bool::_  )
     returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_, out5:bool::_,
             out6:bool::_, out7:bool::_, out8:bool::_, out9:bool::_, out10:bool::_,
             out11:bool::_, out12:bool::_, out13:bool::_, out14:bool::_, out15:bool::_,
             out16:bool::_, out17:bool::_, out18:bool::_, out19:bool::_, out20:bool::_,
             out21:bool::_, out22:bool::_, out23:bool::_, out24:bool::_, out25:bool::_,
             out26:bool::_, out27:bool::_, out28:bool::_, out29:bool::_, out30:bool::_,
             out31:bool::_, out32:bool::_, out33:bool::_, out34:bool::_, out35:bool::_,
             out36:bool::_, out37:bool::_, out38:bool::_, out39:bool::_, out40:bool::_,
             out41:bool::_, out42:bool::_, out43:bool::_, out44:bool::_, out45:bool::_,
             out46:bool::_, out47:bool::_, out48:bool::_ 
let
    out1 = a32;
    out2 = a1;
    out3 = a2;
    out4 = a3;
    out5 = a4;
    out6 = a5;
    out7 = a4;
    out8 = a5;
    out9 = a6;
    out10 = a7;
    out11 = a8;
    out12 = a9;
    out13 = a8;
    out14 = a9;
    out15 = a10;
    out16 = a11;
    out17 = a12;
    out18 = a13;
    out19 = a12;
    out20 = a13;
    out21 = a14;
    out22 = a15;
    out23 = a16;
    out24 = a17;
    out25 = a16;
    out26 = a17;
    out27 = a18;
    out28 = a19;
    out29 = a20;
    out30 = a21;
    out31 = a20;
    out32 = a21;
    out33 = a22;
    out34 = a23;
    out35 = a24;
    out36 = a25;
    out37 = a24;
    out38 = a25;
    out39 = a26;
    out40 = a27;
    out41 = a28;
    out42 = a29;
    out43 = a28;
    out44 = a29;
    out45 = a30;
    out46 = a31;
    out47 = a32;
    out48 = a1
tel


node init_p (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_,
         a7:bool::_, a8:bool::_, a9:bool::_, a10:bool::_, a11:bool::_, a12:bool::_,
         a13:bool::_, a14:bool::_, a15:bool::_, a16:bool::_, a17:bool::_, a18:bool::_,
         a19:bool::_, a20:bool::_, a21:bool::_, a22:bool::_, a23:bool::_, a24:bool::_,
         a25:bool::_, a26:bool::_, a27:bool::_, a28:bool::_, a29:bool::_, a30:bool::_,
         a31:bool::_, a32:bool::_, a33:bool::_, a34:bool::_, a35:bool::_, a36:bool::_,
         a37:bool::_, a38:bool::_, a39:bool::_, a40:bool::_, a41:bool::_, a42:bool::_,
         a43:bool::_, a44:bool::_, a45:bool::_, a46:bool::_, a47:bool::_, a48:bool::_,
         a49:bool::_, a50:bool::_, a51:bool::_, a52:bool::_, a53:bool::_, a54:bool::_,
         a55:bool::_, a56:bool::_, a57:bool::_, a58:bool::_, a59:bool::_, a60:bool::_,
         a61:bool::_, a62:bool::_, a63:bool::_, a64:bool::_)
    returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_, out5:bool::_,
            out6:bool::_, out7:bool::_, out8:bool::_, out9:bool::_, out10:bool::_,
            out11:bool::_, out12:bool::_, out13:bool::_, out14:bool::_, out15:bool::_,
            out16:bool::_, out17:bool::_, out18:bool::_, out19:bool::_, out20:bool::_,
            out21:bool::_, out22:bool::_, out23:bool::_, out24:bool::_, out25:bool::_,
            out26:bool::_, out27:bool::_, out28:bool::_, out29:bool::_, out30:bool::_,
            out31:bool::_, out32:bool::_, out33:bool::_, out34:bool::_, out35:bool::_,
            out36:bool::_, out37:bool::_, out38:bool::_, out39:bool::_, out40:bool::_,
            out41:bool::_, out42:bool::_, out43:bool::_, out44:bool::_, out45:bool::_,
            out46:bool::_, out47:bool::_, out48:bool::_, out49:bool::_, out50:bool::_,
            out51:bool::_, out52:bool::_, out53:bool::_, out54:bool::_, out55:bool::_,
            out56:bool::_, out57:bool::_, out58:bool::_, out59:bool::_, out60:bool::_,
            out61:bool::_, out62:bool::_, out63:bool::_, out64:bool::_
let
    out1=a58;
    out2=a50;
    out3=a42;
    out4=a34;
    out5=a26;
    out6=a18;
    out7=a10;
    out8=a2;
    out9=a60;
    out10=a52;
    out11=a44;
    out12=a36;
    out13=a28;
    out14=a20;
    out15=a12;
    out16=a4;
    out17=a62;
    out18=a54;
    out19=a46;
    out20=a38;
    out21=a30;
    out22=a22;
    out23=a14;
    out24=a6;
    out25=a64;
    out26=a56;
    out27=a48;
    out28=a40;
    out29=a32;
    out30=a24;
    out31=a16;
    out32=a8;
    out33=a57;
    out34=a49;
    out35=a41;
    out36=a33;
    out37=a25;
    out38=a17;
    out39=a9;
    out40=a1;
    out41=a59;
    out42=a51;
    out43=a43;
    out44=a35;
    out45=a27;
    out46=a19;
    out47=a11;
    out48=a3;
    out49=a61;
    out50=a53;
    out51=a45;
    out52=a37;
    out53=a29;
    out54=a21;
    out55=a13;
    out56=a5;
    out57=a63;
    out58=a55;
    out59=a47;
    out60=a39;
    out61=a31;
    out62=a23;
    out63=a15;
    out64=a7
tel

node final_p (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_,
         a7:bool::_, a8:bool::_, a9:bool::_, a10:bool::_, a11:bool::_, a12:bool::_,
         a13:bool::_, a14:bool::_, a15:bool::_, a16:bool::_, a17:bool::_, a18:bool::_,
         a19:bool::_, a20:bool::_, a21:bool::_, a22:bool::_, a23:bool::_, a24:bool::_,
         a25:bool::_, a26:bool::_, a27:bool::_, a28:bool::_, a29:bool::_, a30:bool::_,
         a31:bool::_, a32:bool::_, a33:bool::_, a34:bool::_, a35:bool::_, a36:bool::_,
         a37:bool::_, a38:bool::_, a39:bool::_, a40:bool::_, a41:bool::_, a42:bool::_,
         a43:bool::_, a44:bool::_, a45:bool::_, a46:bool::_, a47:bool::_, a48:bool::_,
         a49:bool::_, a50:bool::_, a51:bool::_, a52:bool::_, a53:bool::_, a54:bool::_,
         a55:bool::_, a56:bool::_, a57:bool::_, a58:bool::_, a59:bool::_, a60:bool::_,
         a61:bool::_, a62:bool::_, a63:bool::_, a64:bool::_)
    returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_, out5:bool::_,
            out6:bool::_, out7:bool::_, out8:bool::_, out9:bool::_, out10:bool::_,
            out11:bool::_, out12:bool::_, out13:bool::_, out14:bool::_, out15:bool::_,
            out16:bool::_, out17:bool::_, out18:bool::_, out19:bool::_, out20:bool::_,
            out21:bool::_, out22:bool::_, out23:bool::_, out24:bool::_, out25:bool::_,
            out26:bool::_, out27:bool::_, out28:bool::_, out29:bool::_, out30:bool::_,
            out31:bool::_, out32:bool::_, out33:bool::_, out34:bool::_, out35:bool::_,
            out36:bool::_, out37:bool::_, out38:bool::_, out39:bool::_, out40:bool::_,
            out41:bool::_, out42:bool::_, out43:bool::_, out44:bool::_, out45:bool::_,
            out46:bool::_, out47:bool::_, out48:bool::_, out49:bool::_, out50:bool::_,
            out51:bool::_, out52:bool::_, out53:bool::_, out54:bool::_, out55:bool::_,
            out56:bool::_, out57:bool::_, out58:bool::_, out59:bool::_, out60:bool::_,
            out61:bool::_, out62:bool::_, out63:bool::_, out64:bool::_
let
    out1=a40;
    out2=a8;
    out3=a48;
    out4=a16;
    out5=a56;
    out6=a24;
    out7=a64;
    out8=a32;
    out9=a39;
    out10=a7;
    out11=a47;
    out12=a15;
    out13=a55;
    out14=a23;
    out15=a63;
    out16=a31;
    out17=a38;
    out18=a6;
    out19=a46;
    out20=a14;
    out21=a54;
    out22=a22;
    out23=a62;
    out24=a30;
    out25=a37;
    out26=a5;
    out27=a45;
    out28=a13;
    out29=a53;
    out30=a21;
    out31=a61;
    out32=a29;
    out33=a36;
    out34=a4;
    out35=a44;
    out36=a12;
    out37=a52;
    out38=a20;
    out39=a60;
    out40=a28;
    out41=a35;
    out42=a3;
    out43=a43;
    out44=a11;
    out45=a51;
    out46=a19;
    out47=a59;
    out48=a27;
    out49=a34;
    out50=a2;
    out51=a42;
    out52=a10;
    out53=a50;
    out54=a18;
    out55=a58;
    out56=a26;
    out57=a33;
    out58=a1;
    out59=a41;
    out60=a9;
    out61=a49;
    out62=a17;
    out63=a57;
    out64=a25
tel


node permut (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_,
         a7:bool::_, a8:bool::_, a9:bool::_, a10:bool::_, a11:bool::_, a12:bool::_,
         a13:bool::_, a14:bool::_, a15:bool::_, a16:bool::_, a17:bool::_, a18:bool::_,
         a19:bool::_, a20:bool::_, a21:bool::_, a22:bool::_, a23:bool::_, a24:bool::_,
         a25:bool::_, a26:bool::_, a27:bool::_, a28:bool::_, a29:bool::_, a30:bool::_,
         a31:bool::_, a32:bool::_ )
    returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_, out5:bool::_,
            out6:bool::_, out7:bool::_, out8:bool::_, out9:bool::_, out10:bool::_,
            out11:bool::_, out12:bool::_, out13:bool::_, out14:bool::_, out15:bool::_,
            out16:bool::_, out17:bool::_, out18:bool::_, out19:bool::_, out20:bool::_,
            out21:bool::_, out22:bool::_, out23:bool::_, out24:bool::_, out25:bool::_,
            out26:bool::_, out27:bool::_, out28:bool::_, out29:bool::_, out30:bool::_,
            out31:bool::_, out32:bool::_
let
    out1=a16;
    out2=a7;
    out3=a20;
    out4=a21;
    out5=a29;
    out6=a12;
    out7=a28;
    out8=a17;
    out9=a1;
    out10=a15;
    out11=a23;
    out12=a26;
    out13=a5;
    out14=a18;
    out15=a31;
    out16=a10;
    out17=a2;
    out18=a8;
    out19=a24;
    out20=a14;
    out21=a32;
    out22=a27;
    out23=a3;
    out24=a9;
    out25=a19;
    out26=a13;
    out27=a30;
    out28=a6;
    out29=a22;
    out30=a1;
    out31=a4;
    out32=a25
tel


node pc_1 (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_,
         a7:bool::_, a8:bool::_, a9:bool::_, a10:bool::_, a11:bool::_, a12:bool::_,
         a13:bool::_, a14:bool::_, a15:bool::_, a16:bool::_, a17:bool::_, a18:bool::_,
         a19:bool::_, a20:bool::_, a21:bool::_, a22:bool::_, a23:bool::_, a24:bool::_,
         a25:bool::_, a26:bool::_, a27:bool::_, a28:bool::_, a29:bool::_, a30:bool::_,
         a31:bool::_, a32:bool::_, a33:bool::_, a34:bool::_, a35:bool::_, a36:bool::_,
         a37:bool::_, a38:bool::_, a39:bool::_, a40:bool::_, a41:bool::_, a42:bool::_,
         a43:bool::_, a44:bool::_, a45:bool::_, a46:bool::_, a47:bool::_, a48:bool::_,
         a49:bool::_, a50:bool::_, a51:bool::_, a52:bool::_, a53:bool::_, a54:bool::_,
         a55:bool::_, a56:bool::_, a57:bool::_, a58:bool::_, a59:bool::_, a60:bool::_,
         a61:bool::_, a62:bool::_, a63:bool::_, a64:bool::_ )
    returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_, out5:bool::_,
            out6:bool::_, out7:bool::_, out8:bool::_, out9:bool::_, out10:bool::_,
            out11:bool::_, out12:bool::_, out13:bool::_, out14:bool::_, out15:bool::_,
            out16:bool::_, out17:bool::_, out18:bool::_, out19:bool::_, out20:bool::_,
            out21:bool::_, out22:bool::_, out23:bool::_, out24:bool::_, out25:bool::_,
            out26:bool::_, out27:bool::_, out28:bool::_, out29:bool::_, out30:bool::_,
            out31:bool::_, out32:bool::_, out33:bool::_, out34:bool::_, out35:bool::_,
            out36:bool::_, out37:bool::_, out38:bool::_, out39:bool::_, out40:bool::_,
            out41:bool::_, out42:bool::_, out43:bool::_, out44:bool::_, out45:bool::_,
            out46:bool::_, out47:bool::_, out48:bool::_, out49:bool::_, out50:bool::_,
            out51:bool::_, out52:bool::_, out53:bool::_, out54:bool::_, out55:bool::_,
            out56:bool::_
let
    out1=a57;
    out2=a49;
    out3=a41;
    out4=a33;
    out5=a25;
    out6=a17;
    out7=a9;
    out8=a1;
    out9=a58;
    out10=a50;
    out11=a42;
    out12=a34;
    out13=a26;
    out14=a18;
    out15=a10;
    out16=a2;
    out17=a59;
    out18=a51;
    out19=a43;
    out20=a35;
    out21=a27;
    out22=a19;
    out23=a11;
    out24=a3;
    out25=a60;
    out26=a52;
    out27=a44;
    out28=a36;
    out29=a63;
    out30=a55;
    out31=a47;
    out32=a39;
    out33=a31;
    out34=a23;
    out35=a15;
    out36=a7;
    out37=a62;
    out38=a54;
    out39=a46;
    out40=a38;
    out41=a30;
    out42=a22;
    out43=a14;
    out44=a6;
    out45=a61;
    out46=a53;
    out47=a45;
    out48=a37;
    out49=a29;
    out50=a21;
    out51=a13;
    out52=a5;
    out53=a28;
    out54=a20;
    out55=a12;
    out56=a4
tel

node pc_2 (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_,
         a7:bool::_, a8:bool::_, a9:bool::_, a10:bool::_, a11:bool::_, a12:bool::_,
         a13:bool::_, a14:bool::_, a15:bool::_, a16:bool::_, a17:bool::_, a18:bool::_,
         a19:bool::_, a20:bool::_, a21:bool::_, a22:bool::_, a23:bool::_, a24:bool::_,
         a25:bool::_, a26:bool::_, a27:bool::_, a28:bool::_, a29:bool::_, a30:bool::_,
         a31:bool::_, a32:bool::_, a33:bool::_, a34:bool::_, a35:bool::_, a36:bool::_,
         a37:bool::_, a38:bool::_, a39:bool::_, a40:bool::_, a41:bool::_, a42:bool::_,
         a43:bool::_, a44:bool::_, a45:bool::_, a46:bool::_, a47:bool::_, a48:bool::_,
         a49:bool::_, a50:bool::_, a51:bool::_, a52:bool::_, a53:bool::_, a54:bool::_,
         a55:bool::_, a56:bool::_ )
    returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_, out5:bool::_,
            out6:bool::_, out7:bool::_, out8:bool::_, out9:bool::_, out10:bool::_,
            out11:bool::_, out12:bool::_, out13:bool::_, out14:bool::_, out15:bool::_,
            out16:bool::_, out17:bool::_, out18:bool::_, out19:bool::_, out20:bool::_,
            out21:bool::_, out22:bool::_, out23:bool::_, out24:bool::_, out25:bool::_,
            out26:bool::_, out27:bool::_, out28:bool::_, out29:bool::_, out30:bool::_,
            out31:bool::_, out32:bool::_, out33:bool::_, out34:bool::_, out35:bool::_,
            out36:bool::_, out37:bool::_, out38:bool::_, out39:bool::_, out40:bool::_,
            out41:bool::_, out42:bool::_, out43:bool::_, out44:bool::_, out45:bool::_,
            out46:bool::_, out47:bool::_, out48:bool::_
let
    out1=a14;
    out2=a17;
    out3=a11;
    out4=a24;
    out5=a1;
    out6=a5;
    out7=a3;
    out8=a28;
    out9=a15;
    out10=a6;
    out11=a21;
    out12=a10;
    out13=a23;
    out14=a19;
    out15=a12;
    out16=a4;
    out17=a26;
    out18=a8;
    out19=a16;
    out20=a7;
    out21=a27;
    out22=a20;
    out23=a13;
    out24=a2;
    out25=a41;
    out26=a52;
    out27=a31;
    out28=a37;
    out29=a47;
    out30=a55;
    out31=a30;
    out32=a40;
    out33=a51;
    out34=a45;
    out35=a33;
    out36=a48;
    out37=a44;
    out38=a49;
    out39=a39;
    out40=a56;
    out41=a34;
    out42=a53;
    out43=a46;
    out44=a42;
    out45=a50;
    out46=a36;
    out47=a29;
    out48=a32
tel


node rol_1 (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_,
            a7:bool::_, a8:bool::_, a9:bool::_, a10:bool::_, a11:bool::_, a12:bool::_,
            a13:bool::_, a14:bool::_, a15:bool::_, a16:bool::_, a17:bool::_, a18:bool::_,
            a19:bool::_, a20:bool::_, a21:bool::_, a22:bool::_, a23:bool::_, a24:bool::_,
            a25:bool::_, a26:bool::_, a27:bool::_, a28:bool::_ )
    returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_, out5:bool::_,
            out6:bool::_, out7:bool::_, out8:bool::_, out9:bool::_, out10:bool::_,
            out11:bool::_, out12:bool::_, out13:bool::_, out14:bool::_, out15:bool::_,
            out16:bool::_, out17:bool::_, out18:bool::_, out19:bool::_, out20:bool::_,
            out21:bool::_, out22:bool::_, out23:bool::_, out24:bool::_, out25:bool::_,
            out26:bool::_, out27:bool::_, out28:bool::_
let
    out1 = a28;
    out2 = a1;
    out3 = a2;
    out4 = a3;
    out5 = a4;
    out6 = a5;
    out7 = a6;
    out8 = a7;
    out9 = a8;
    out10 = a9;
    out11 = a10;
    out12 = a11;
    out13 = a12;
    out14 = a13;
    out15 = a14;
    out16 = a15;
    out17 = a16;
    out18 = a17;
    out19 = a18;
    out20 = a19;
    out21 = a20;
    out22 = a21;
    out23 = a22;
    out24 = a23;
    out25 = a24;
    out26 = a25;
    out27 = a26;
    out28 = a27
tel


node rol_2 (a1:bool::_, a2:bool::_, a3:bool::_, a4:bool::_, a5:bool::_, a6:bool::_,
            a7:bool::_, a8:bool::_, a9:bool::_, a10:bool::_, a11:bool::_, a12:bool::_,
            a13:bool::_, a14:bool::_, a15:bool::_, a16:bool::_, a17:bool::_, a18:bool::_,
            a19:bool::_, a20:bool::_, a21:bool::_, a22:bool::_, a23:bool::_, a24:bool::_,
            a25:bool::_, a26:bool::_, a27:bool::_, a28:bool::_ )
    returns out1:bool::_, out2:bool::_, out3:bool::_, out4:bool::_, out5:bool::_,
            out6:bool::_, out7:bool::_, out8:bool::_, out9:bool::_, out10:bool::_,
            out11:bool::_, out12:bool::_, out13:bool::_, out14:bool::_, out15:bool::_,
            out16:bool::_, out17:bool::_, out18:bool::_, out19:bool::_, out20:bool::_,
            out21:bool::_, out22:bool::_, out23:bool::_, out24:bool::_, out25:bool::_,
            out26:bool::_, out27:bool::_, out28:bool::_
let
    out1 = a27;
    out2 = a28;
    out3 = a1;
    out4 = a2;
    out5 = a3;
    out6 = a4;
    out7 = a5;
    out8 = a6;
    out9 = a7;
    out10 = a8;
    out11 = a9;
    out12 = a10;
    out13 = a11;
    out14 = a12;
    out15 = a13;
    out16 = a14;
    out17 = a15;
    out18 = a16;
    out19 = a17;
    out20 = a18;
    out21 = a19;
    out22 = a20;
    out23 = a21;
    out24 = a22;
    out25 = a23;
    out26 = a24;
    out27 = a25;
    out28 = a26
tel


node des (plaintext : uint_64::_, key : uint_64::_) returns ciphered : uint_64::_
vars
    left  : uint_32::_,
    right : uint_32::_,
    roundkey : uint_48::_,
    expanded : uint_48::_,
    s1 : uint_6::_, s2 : uint_6::_, s3 : uint_6::_,
    s4 : uint_6::_, s5 : uint_6::_, s6 : uint_6::_, 
    c : uint_32::_,
    permuted_c : uint_32::_
let

    # Initial permutation, and splitting into left and right 
    (left, right) = init_p(a);

    ################## Main part (the 16 rounds) ##################

    ##### Round 1 #####

    # Expantion of R
    expanded = expand(r);
    roundkey = roundkey1(key); # Note: roundkey1 isn't defined yet.
    

    # Xoring key and R
    (s1,s2,s3,s4,s5,s6)
          = xor(expanded, roundkey);
          
    # Sboxes (and permutation)
    c = permut( sbox_1(s1), sbox_2(s2), sbox_3(s3), sbox_4(s4),
                sbox_5(s5), sbox_6(s6), sbox_7(s7), sbox_8(s8) );

    (left,right) = (right,xor(left,c);

    ##### Round 2-16 not implemented #####

    # .....


    # Regrouping left and right and computing final permuation
    out = final_p(left, right)    
tel
